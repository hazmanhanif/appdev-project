{% extends 'base.html' %}

{% block title %}library||textbook{% endblock %}

{% block content %}

  <header class="md:col-span-6 bg-stone-900 mb-2 py-2 text-white  rounded shadow-md">
    <h1 class="text-2xl font-semibold text-white text-center py-5">Welcome to SMK ORKID DESA Library Textbook Page</h1>
    <a href="{% url 'homeapp:library_index' %}?botId={{ bot_id }}" class="block w-1/5 bg-gradient-to-l from-stone-500 to-stone-100 rounded shadow-md py-2">
      <h1 class="text-base font-semibold text-center"> Go to library-dashboard </h1>
    </a>
  </header>

  {% if messages %}
  <div class="bg-green-200 p-2 text-center text-stone-800">
        <ul>
            {% for message in messages %}
            <li>{{ message }}</li>
            {% endfor %}
        </ul>
    </div>
  {% endif %}

  <div class="container mx-auto bg-transparent py-10 px-10 text-gray-800 min-h-screen rounded shadow-md">
    <div class="w-2/3 mx-auto rounded shadow-lg p-5 h-full block">
      <!-- Display classes, students, and textbooks -->
      {% for class_data in class_students_textbooks %}
      <h2>{{ class_data.class_obj.classname }}</h2>
      <ul>
          {% for student_data in class_data.class_students %}
              <li>
                  <strong>Student: </strong>{{ student_data.student.username }}
                  <ul>
                      {% for textbook in student_data.textbooks %}
                          <li>
                              <p>Book Title: {{ textbook.textbook.book_title }}</p>
                              <!-- Form for updating status -->
                              <form method="post">
                                  {% csrf_token %}
                                  <input type="hidden" name="student_id" value="{{ student_data.student.id }}">
                                  <input type="hidden" name="textbook_id" value="{{ textbook.textbook.id }}">
                                  <label for="status">Status:</label>
                                  <select name="status" id="status">
                                      <option value="collected" {% if textbook.status == 'collected' %} selected {% endif %}>Collected</option>
                                      <option value="not_collected" {% if textbook.status == 'not_collected' %} selected {% endif %}>Not Collected</option>
                                      <option value="returned" {% if textbook.status == 'returned' %} selected {% endif %}>Returned</option>
                                  </select>
                                  <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Update Status</button>
                              </form>
                          </li>
                      {% endfor %}
                  </ul>
              </li>
          {% endfor %}
      </ul>
      {% endfor %}

    </div>
  </div>  

{% endblock %}
